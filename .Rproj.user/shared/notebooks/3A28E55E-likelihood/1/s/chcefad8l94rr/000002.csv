"0","fnct_direct_r <- function(r, max_m_loglikelihood, gamma = 0.15) {"
"0","  m <- m_estimate #mle for M under r is just m_estimate"
"0","  "
"0","  f <-  (max_m_loglikelihood - calc_negbinom_loglik_profile(m = m ,r =r)) +1*log(gamma) #this value should be zero for the constraints to be satisfied"
"0","  #replcae qchisq() with a random gamma cutoff if necesary"
"0","  "
"0","}"
"0","#here is an example of how to do direct likelihood for M"
"0","lower_bound_direct_interval_r <- uniroot(fnct_direct_r, c(0.1, r_estimate) , max_m_loglikelihood = max_m_loglikelihood)"
"0","upper_bound_direct_interval_r <- uniroot(fnct_direct_r, c(r_estimate, 0.9) , max_m_loglikelihood = max_m_loglikelihood)"
"0","direct_interval_r <- c(lower_bound_direct_interval_r$root,upper_bound_direct_interval_r$root)"
