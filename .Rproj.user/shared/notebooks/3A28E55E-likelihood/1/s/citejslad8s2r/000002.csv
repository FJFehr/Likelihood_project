"0","fnct_direct <- function(m, max_m_loglikelihood, gamma = 0.15) {"
"0","  # out <- #using function that i used to calculate joint MLE for m and R the only downside to this is that it is NOT taking in different shape parameters...check out the function"
"0","  # optim("
"0","  # par = m,"
"0","  # fn = calc_negbinom_loglik ,"
"0","  # control = list(fnscale = -1),"
"0","  # lower = 3,"
"0","  # upper = 30 ,"
"0","  # method = ""L-BFGS-B"""
"0","  # )"
"0","  "
"0","  r <- m^2 /(var(x) - m )"
"0","  "
"0","  f <-  (max_m_loglikelihood - calc_negbinom_loglik_profile(m = m ,r =r)) +1*log(gamma) #this value should be zero for the constraints to be satisfied"
"0","  #replcae qchisq() with a random gamma cutoff if necesary"
"0","  "
"0","}"
"0","#here is an example of how to do direct likelihood for M"
"0","lower_bound_direct_interval_m <- uniroot(fnct_direct, c(1, m_estimate) , max_m_loglikelihood = max_m_loglikelihood)"
"0","upper_bound_direct_interval_m <- uniroot(fnct_direct, c(m_estimate, 52) , max_m_loglikelihood = max_m_loglikelihood)"
"0","direct_interval_m <- c(lower_bound_direct_interval_m$root,upper_bound_direct_interval_m$root)"
"0","data_frame('Lower bound'= direct_interval_m[1] , 'Upper bound' = direct_interval_m[2]) %>% knitr::kable(caption = "" interval for m parameter"")"
"1","

"
"1","| Lower bound| Upper bound|"
"1","
"
"1","|-----------:|-----------:|"
"1","
"
"1","|    6.587527|     7.03714|"
"1","
"
