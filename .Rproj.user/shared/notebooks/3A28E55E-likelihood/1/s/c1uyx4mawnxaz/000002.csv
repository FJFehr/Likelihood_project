"0","calc_poissmix_loglik <- function(par){"
"0","  lambda_1 <- par[1]"
"0","  lambda_2 <- par[2]"
"0","  p <- par[3]"
"0","  "
"0","  loglik <- sum(log(p * dpois(x = x, lambda = lambda_1) + (1-p)*dpois(x = x, lambda = lambda_2)))"
"0","  "
"0","  return(loglik)"
"0","  "
"0","}"
"0","#If we maximise loglikelihood, we will be minimising AIC"
"0","mle_poismix <-"
"0","  optim("
"0","  par = c(25,10,0.5), "
"0","  fn = calc_poissmix_loglik ,"
"0","  control = list(fnscale = -1), #maximise "
"0","  lower = c(0.1,0.1,0),"
"0","  upper = c(100,100,1) ,"
"0","  method = ""L-BFGS-B"""
"0","  )"
"0","lambda_1_estimate <- round(mle_poismix$par[1],4)"
"0","lambda_2_estimate <- round(mle_poismix$par[2],4)"
"0","p_estimate <- round(mle_poismix$par[3],4)"
"0","aic_poismix <- round(-2*mle_poismix$value + 2*(3),2)"
"0","bic_poismix <- round(-2*mle_poismix$value + log(n),2)"
"0","data_frame(`$\\hat{\\lambda_1}$`= lambda_1_estimate , `$\\hat{\\lambda_2}$` = lambda_2_estimate, `Proportion p` = p_estimate, AIC = aic_poismix, BIC = bic_poismix) %>% knitr::kable(caption = ""Poisson-Poisson MLE's & information metrics"")"
"1","

"
"1","| $\hat{\lambda_1}$| $\hat{\lambda_2}$| Proportion p|      AIC|      BIC|"
"1","
"
"1","|-----------------:|-----------------:|------------:|--------:|--------:|"
"1","
"
"1","|           19.3809|            2.8407|       0.2465| 12075.12| 12076.52|"
"1","
"
