"0","calc_poissmix_loglik <- function(par){"
"0","  lambda_1 <- par[1]"
"0","  lambda_2 <- par[2]"
"0","  p <- par[3]"
"0","  "
"0","  loglik <- sum(log(p * dpois(x = x, lambda = lambda_1) + (1-p)*dpois(x = x, lambda = lambda_2)))"
"0","  "
"0","  return(loglik)"
"0","  "
"0","}"
"0","#If we maximise loglikelihood, we will be minimising AIC"
"0","mle_poismix <-"
"0","  optim("
"0","  par = c(25,10,0.5), "
"0","  fn = calc_poissmix_loglik ,"
"0","  control = list(fnscale = -1), #maximise "
"0","  lower = c(0.1,0.1,0),"
"0","  upper = c(100,100,1) ,"
"0","  method = ""L-BFGS-B"""
"0","  )"
"0","lambda_1_estimate <- mle_poismix$par[1]"
"0","lambda_2_estimate <- mle_poismix$par[2]"
"0","p_estimate <- mle_poismix$par[3]"
"0","aic_poismix <- -2*mle_poismix$value + 2*(3)"
"0","data_frame(`Lamda 1 estimate`= lambda_1_estimate , `Lambda 2 estimate` = lambda_2_estimate, `Mixing Parameter p` = p_estimate, AIC = aic_poismix) %>% knitr::kable()"
"1","

"
"1","| Lamda 1 estimate| Lambda 2 estimate| Mixing Parameter p|      AIC|"
"1","
"
"1","|----------------:|-----------------:|------------------:|--------:|"
"1","
"
"1","|         19.38094|           2.84069|          0.2465036| 12075.12|"
"1","
"
